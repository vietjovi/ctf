p = 0xE95E4A5F737059DC60DFC7AD95B3D8139515620F
A = 0x340E7BE2A280EB74E2BE61BADA745D97E8F7C300
B = 0x1E589A8595423412134FAA2DBDEC95C8D8675E58
x = 0xBED5AF16EA3F6A4F62938C4631EB5AF7BDBCDBC3
y = 0x1667CB477A1A8EC338F94741669C976316DA6321
q = 0xE95E4A5F737059DC60DF5991D45029409E60FC09 # Order
v = 0x898CB2616E46E8F01CB4C05732EB89D921543FE3
txpk1 = [(0x898CB2616E46E8F01CB4C05732EB89D921543FE3,0x0000000000000000000000000000000000000000),
(0x7631DC05F1954DA902E29FC8E2E7EC21A80C5CA4,0x74657D752620FD5E46628039AF3409C6CB209C5F),
(0x44F83E88F0F73DC921DF3D6B4A029B6B03EA7B8A,0x4F69898B5B204BDB01974706A3EBF8C4B120DB9C),
(0xD229562860D0DA42A3F40825812D3DB380FD4787,0x957860E7C2F662C359863D0531271938CDE721F1),
(0x170AB66B15E0098B371E1028135F415FD389E310,0xAB7F9C16D9A485F0D74202B5F2E695BB820D033D),
(0x9B1808809C73D0A3F65A531AFBA5583D4E449F56,0xABC4FF37C33504F414C769542CE040815625FAB6),
(0x43381EA83509B33DB345D761F238A9256B0206A8,0xBE623184FEBC236E13A948DDBF94ECD2132B48BB),
(0x3980BBCE78DF7DB4FEF33C7EF5D9890D38A1720E,0x5E1FE8D275B1461592B57D331882A3E40E4D8B07),
(0xAB3CCC4B8D0E3216B8383EE7376FC93EA8451764,0x4B4077DBB69673DAF3AE3150D8128AD9DF380CB0),
(0x7385972D154A7A1A9F0911A18C6689949F2657B1,0x3486C1B313C7AEB9BBC9415130BE8CFB47136F2C),
(0xD17FC9A9BB05205821591158EB8425A6256B67EB,0x5DC0A9DB5FF9C980E439B44AFC3B78944E1962A1),
(0xA9D6B365DA91FA05B08B094D8C5BAC6612DD208D,0xAEBA5DC083F43BE9EF431EC10AB809F3899D0FA6),
(0x97B91F2CE1FE4BAC3AA39F0204F105DD2FC65A2F,0x34C53297CEBB548791D027B90E3D5E9D72C0C23F),
(0xA1A6E2B73DCC45EAC48783A4C6A78F0B2B06402D,0x748D08924A7769DD9855EB9B0132B9D97C677A3D),
(0x996F7B31B482C9A7C6C0BA638F4C39C4B378F823,0x47448614C86462E32346CDAFE559287F5B767515),
(0x52B7007DB336E70CD3DC8CA088A89BF0A2FE2718,0x13C6658B2721BB5BF9C6427F50A2625F14114D92),
(0x5F60EBB6587A1D7358E5BB4A4EFF5DEA290A8D0A,0x77725D8C6EB1C796D03CD9C451A0D1783BE035AE),
(0x84045CBD05763F630F2535770C4B7F5D678DCCCC,0xAC48DAB92896F45BF60B36C91BDA418ECED6E546),
(0xA7CB2BB6BF19A9FC477BAD207146FD8EF4DB5BAC,0x790D21C9ED9568C774734614DA3E5913E7A87810),
(0x93B86DA1990B302C94FF40FE01938C77D4146418,0x460D131080AF54DC342FEBD97162D5215BB028DA),
(0x188CDFC6ED3FE42577CE2385187F7DA872F6AF04,0xD966F7A0B1F6880CFCD326E4F71CA93E5F1048F6),
(0x44BE5C0FBBA6ED5A56C9E684A9BCC9C8AEB9255F,0x84E8AA81586BF751023F45FE2795C7B6A27FCB0F)]

txpk2 = [(0x898CB2616E46E8F01CB4C05732EB89D921543FE3,0x0000000000000000000000000000000000000000),
(0x7631DC05F1954DA902E29FC8E2E7EC21A80C5CA4,0x74657D752620FD5E46628039AF3409C6CB209C5F),
(0x161BBF1226F95B8774E1A36DECC20D9774099DCB,0x487A327204565B2B10410681AD0F81367A8B8C9F),
(0xD229562860D0DA42A3F40825812D3DB380FD4787,0x957860E7C2F662C359863D0531271938CDE721F1),
(0x48441C6F9D744D72D872E0BE9BA2B1DDBEF12B2E,0x34AE26E93DBBA1AD366DED0E664AFD7EB1E9562B),
(0x547F2D44BF42E61371D1478E5FC8C76764E45041,0x08979358FEF026174CED242226C4B19EBAF03EF7),
(0xE0061588ADAE4671E1D2C0B4A9E01340A3AD8908,0x01E048143B073AD21918EFDBB6ED525A6A3220BF),
(0x50BC68926130E24542830B5A546C3F4690E370A3,0x766BE509C344710FCB01A0F235EFEEBE464D93B5),
(0x8686A07F6544B384B3AAA0FDA2344D6F8078BA1E,0xDB52576D511BCE22159E3B48521AA7D124C03E26),
(0x9598C16277BF6F9FD2AF1E1DFC3108AA4DBF35E0,0x474D3D8170C6A2E7B3A6B7BAF1BC52EBAA2D90DB),
(0xC97396948AE636D0012246750AA64A264DA6ADFA,0x76B015CBD383B8FB3A36D26E8C599C734EF5E3A0),
(0x19526078F8E4C3C33BECC466E256AD3FE1A58C18,0x803065B138B88E5FB6835051C0E4C06B1C500AA7),
(0xA2305767A4FD5A45D7520554C08F2F8AFFB0988C,0x962CF4089B35767C7FF6D653FB080D8648F552F8),
(0xE409901D98E3884B4E15C33982333A021124CD89,0x025DC6EE4E99C1187BEB1F19E89397ED8D2845B0),
(0x37B7F8658311F8A77C098AF6FCA4F111800CD8F5,0xC21D090CBA9A7824889FC86B2691E7C22958CD32),
(0xC24F6A8D82D5D9C6CBC4D24F9DB28E06D7B73C19,0x115DFF8D8547B4BE1EDA04D2BFF0C576F0A5E5C3),
(0xA0B31C3B2090D12DEAF87E65756DFB0850D6B608,0x76E769561205B08CD5B67B1C2767326FEFDE6113),
(0xE375ED0442A3B99276F200977088032E504FD107,0x7E24693F99EAC1F2082F5AC5AB337E99473CFB5D),
(0xB4BE47D0A516012DD76963F5CB60CA674B368735,0xD9889300540867A495C3CE8F772C46DB49E70086),
(0x3A33790B193974A2D085EC52D6BC530CF63B20AB,0x61120114A378C64934E8C8401FD5C539EE20AF68),
(0x85F567F520BE83C9E2F3432A331A0F9FA45E1C79,0x8707B631F09B36063401749AA5372899D1566218),
(0xBA1D6A28988BBE44B78A9D800ADFA7CCA309A37B,0x9430AFAA57D622D49189217F1D9780B336D84218)]

dlogs = []
primes = []
count = 0

for i in txpk1:
    x = int(i[0])
    y = int(i[1])
    bb = (y*y - x*x*x - A*x) % p

    E = EllipticCurve(GF(p),[int(A),bb])
    G = E(x,y)
    G1 = E(txpk2[count])
    ord1 = G.order()
    dlog = G.discrete_log(G1)
    print "K mod " + str(ord1) + " = " + str(dlog)
    dlogs += [dlog]
    primes += [ord1]
    count = count + 1
l = crt(dlogs, primes)
print dlogs
print primes
print "=> K =" + str(l)
print "hex(l) = "+ str(hex(l))                     

print "----------------"
print "DONE!"
